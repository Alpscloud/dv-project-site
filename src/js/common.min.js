document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".input__file");Array.prototype.forEach.call(e,function(e){var t=e.parentNode,i=t.innerHTML;e.addEventListener("change",function(e){var s="",n=t.nextElementSibling;n.classList.contains("active")&&n.classList.remove("active"),(s=this.files&&this.files.length>1?(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value.split("\\").pop())?(n.innerHTML=s,n.classList.add("is-active")):t.innerHTML=i})})}),$(document).ready(function(){var e,t=$("body");t.width();$(".js-smooth-scroll-link").on("click",function(e){e.preventDefault();var t=$(this).attr("href"),i=$(t).offset().top;$("html, body").animate({scrollTop:i},"slow")}),$(".js-open-engineer-popup-btn").on("click",function(e){e.preventDefault(),$(".js-popup-engineer").fadeIn(300),$("html").addClass("is-fixed")}),$(".js-open-consultation-popup-btn").on("click",function(e){e.preventDefault(),$(".js-popup-consultation").fadeIn(300),$("html").addClass("is-fixed")}),$(".js-open-mchs-consultation-popup-btn").on("click",function(e){e.preventDefault(),$(".js-popup-mchs").fadeIn(300),$("html").addClass("is-fixed")}),$(".js-open-service-popup-btn").on("click",function(e){e.preventDefault(),$(".js-popup-service").fadeIn(300),$("html").addClass("is-fixed")}),$(".js-close-popup-btn").on("click",function(e){e.preventDefault(),$(this).parents(".js-popup").fadeOut(300),$("html").removeClass("is-fixed")}),$(".popup__overflow").on("click",function(e){e.stopPropagation();var t=$(this).find(".popup__body");t.is(e.target)||0!==t.has(e.target).length||($("html").removeClass("is-fixed"),$(".js-popup").fadeOut(300))}),$(window).on("scroll",function(){clearTimeout(e),t.hasClass("disable-hover")||t.addClass("disable-hover"),e=setTimeout(function(){t.removeClass("disable-hover")},200)}),$(".js-open-mobile-menu-btn").on("click",function(e){e.preventDefault(),$(this).toggleClass("is-active"),$(".js-nav").stop().slideToggle(150)});new Swiper(".js-portfolio-desktop-slider",{speed:500,spaceBetween:0,slidesPerView:1,pagination:{el:".js-portfolio-desktop-slider-pagination",clickable:!0},navigation:{nextEl:".js-portfolio-desktop-slider-btn-next",prevEl:".js-portfolio-desktop-slider-btn-prev"}}),new Swiper(".js-portfolio-mobile-slider",{slidesPerView:"auto",speed:500,spaceBetween:0,navigation:{nextEl:".js-portfolio-mobile-slider-btn-next",prevEl:".js-portfolio-mobile-slider-btn-prev",disabledClass:"is-disabled"}}),new Swiper(".js-another-projects-slider",{slidesPerView:1,loop:!0,spaceBetween:30,pagination:{el:".js-another-projects-slider-pagination",clickable:!0},breakpoints:{1049:{slidesPerView:3},700:{slidesPerView:2}}}),new Swiper(".js-licenses-slider",{slidesPerView:"auto",touchRatio:1,speed:500,spaceBetween:0,touchRatio:0,autoplay:{delay:4e3,disableOnInteraction:!1},navigation:{nextEl:".js-licenses-slider-btn-next",prevEl:".js-licenses-slider-btn-prev",disabledClass:"is-disabled"},breakpoints:{620:{slidesPerView:3,touchRatio:0,autoplay:{delay:4e3,disableOnInteraction:!1}}}}),new Swiper(".js-feedbacks-slider",{slidesPerView:1,speed:500,loop:!0,spaceBetween:0,navigation:{nextEl:".js-feedbacks-slider-btn-next",prevEl:".js-feedbacks-slider-btn-prev",disabledClass:"is-disabled"}});if($(".js-project-slider-main").length>0){var i=new Swiper(".js-project-slider-thumbnails",{spaceBetween:10,slidesPerView:3,loop:!0,freeMode:!1,loopedSlides:1,watchSlidesVisibility:!0,watchSlidesProgress:!0,touchRatio:0});new Swiper(".js-project-slider-main",{spaceBetween:0,loop:!0,loopedSlides:1,navigation:{nextEl:".js-project-slider-main-btn-next",prevEl:".js-project-slider-main-btn-prev"},thumbs:{swiper:i}})}$("[data-fancybox]").fancybox({toolbar:!1,smallBtn:!0}),$(".js-toggle-feedback-text-btn").on("click",function(e){e.preventDefault(),$(this).toggleClass("is-toggled"),$(this).parents(".feedback").find(".feedback__text span").stop().slideToggle(150)}),$(".js-toggle-faq").on("click",function(e){e.preventDefault(),$(this).parents(".faq__item").toggleClass("is-toggled"),$(this).parents(".faq__item").find(".faq__item--body").stop().slideToggle(170)}),$(".js-input").on("focus",function(){$(this).hasClass("is-error")&&$(this).removeClass("is-error")});var s=!1;$(".js-form").on("submit",function(e){e.preventDefault();var t=$(this);t.find(".form-send-error-text").hide();var i=t.find(".js-input"),n=!0,o=new FormData(t.get(0));$(i).each(function(){$(this).val()&&""!=$(this).val()||($(this).addClass("is-error"),n=!1)});var l=t.find(".form-send-error-text");0==l.length&&(t.find('.btn[type="submit"]').after('<div class="form-send-error-text" style="display:none;"></div>'),l=t.find(".form-send-error-text"));try{for(var a,r=o.getAll("fileFF[]"),p=[],d=0,c=0;a=r[c];c++){var f=a.name;f.split(".")[f.split(".").length-1].toLowerCase();d+=a.size}if(p.length,!1)return n=!1,t.find('.input__file[name="fileFF[]"]').val(""),t.find(".input__file--name").html(""),(l=t.find(".form-send-error-text")).html("Извините, письмо не отправлено. <br>Невозможно загрузить некоторые файлы: "+p.join("<br>")),l.show(),!1;if(d>1e7)return n=!1,t.find('.input__file[name="fileFF[]"]').val(""),t.find(".input__file--name").html(""),(l=t.find(".form-send-error-text")).html('Письмо не может быть отправлено, так как файл весит больше 10мб, вышлете его на почту <a href="mailto:aps@dv-p.ru">aps@dv-p.ru</a>'),l.show(),!1}catch(e){}if(!n)return!1;if(s)return!1;var u=t.find('.btn[type="submit"] .btn__text'),h=u.html();u.html("Идет отправка формы"),s=!0,$.ajax({contentType:!1,processData:!1,type:"POST",url:"/wp-content/themes/dv-project-theme/contacts.php",data:o,success:function(e){u.html(h),s=!1,l=t.find(".form-send-error-text"),"OK"==e?(t.trigger("reset"),t.find(".input__file--name").removeClass("is-active"),l.hide(),window.location.href="/typage"):(l.html(e),l.show())},error:function(e){u.html(h),s=!1,(l=t.find(".form-send-error-text")).html("Ошибка отправки формы"),l.show()}})}),$(".js-input-phone").mask("+7(999)-999-99-99",{placeholder:" "})});